[{"start":{"activity_category":1,"activity":{"cell_id":"97b7cbc9-b038-48aa-b58e-ebdf50ebe5bf","code":8,"params":{"version":"8.2.7","variable_value":{"use_previous_step":false},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"script_id":"b07da97d-f1e9-4b18-9f18-c896be7de695","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"studio_version":{"created":"8.2.7","updated":"9.2.12"},"paper_size":{"height":3476,"width":2361,"x":-164,"y":-2101},"js_file_path":null,"username":null,"timeout":0,"link_vertices":{"0":{"source_id":"54af40ad-f51f-46f5-99a2-9d4ae0ac1d6b","source_port":"exit","target_id":"aeafb5fd-766f-4991-98f7-ec00b1b488cf","vertices":[{"x":348,"y":-859}]},"1":{"source_id":"b56373af-6753-4c07-93d9-320d83fc0462","source_port":"error","target_id":"8336a597-4e38-4e50-b42e-d51f2a7fcecb","vertices":[{"x":615,"y":-1346}]},"2":{"source_id":"35dbd245-3866-402f-ab89-8edf89996100","source_port":"yes","target_id":"8336a597-4e38-4e50-b42e-d51f2a7fcecb","vertices":[{"x":-87,"y":-148},{"x":-70,"y":-1534}]},"3":{"source_id":"7c15bb04-83ce-4a0f-b88b-fcef094869b7","source_port":"no","target_id":"5ba03e86-0249-4a0a-abb6-36d3bdfdab45","vertices":[{"x":680,"y":630}]},"4":{"source_id":"65a006b3-b933-4836-b8ed-bd1bc2ca244a","source_port":"exit","target_id":"5ba03e86-0249-4a0a-abb6-36d3bdfdab45","vertices":[{"x":490,"y":736}]},"5":{"source_id":"90ba4ef0-29b1-4156-8d86-a3244140644a","source_port":"exit","target_id":"a44adb6e-c818-455f-b4a3-e60bbe5ade85","vertices":[{"x":1296,"y":-1493}]},"6":{"source_id":"a3ca6363-e0e0-43f6-a0be-1a44c5b7c9f1","source_port":"error","target_id":"20ceb5f9-5d53-4bc1-853c-7c5b353b3572","vertices":[{"x":625,"y":-1912}]}},"project":{"name":"WecTradeBase","path":"C:\\Users\\User1\\Documents\\WecTradeBase","main":"main.neek","settings":{"variables":[],"performanceSettings":{"automaticallyCreateLogForEachRun":false,"isStatusWindowEnabled":true},"browserSettings":{"useDefaultProfile":true,"useBrowser":"ie","customArgs":"","keepBrowserOpen":true},"doNotCloseWhileDebug":false,"microsoftExcelActivities":"generic","antiCaptcha":true}}}},"position":{"x":310,"y":-2051},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"ce5479b5-cc6f-44eb-89ce-6d202ae4f2d2","code":3,"params":{"version":"4.35.0","variable_name":"robot_name","variable_value":{"value":"WecTradeBase","use_previous_step":false},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":"Robot Name","command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":243,"y":-1953},"next":{"exit":{"activity_category":10,"activity":{"cell_id":"20ceb5f9-5d53-4bc1-853c-7c5b353b3572","code":1,"params":{"version":"4.35.0","url":{"value":"http://worldtimeapi.org/api/timezone/Asia/Almaty","use_previous_step":false},"request_method":{"value":"get","use_previous_step":false},"query_params":{"use_previous_step":true},"body_params":{"use_previous_step":true},"basic_auth_username":"","basic_auth_password":"","token":{"value":null,"use_previous_step":false},"file":{"use_previous_step":false},"file_key":{"use_previous_step":false},"custom_header":{"use_previous_step":false,"statement":""},"comment":"Получить точное время","breakpoint":false,"login":null,"add_certificate":false,"certificate":null,"authorization_url":{"use_previous_step":false},"access_token_url":{"use_previous_step":false},"client_id":{"use_previous_step":false},"client_secret":{"use_previous_step":false},"access_token_scope":{"use_previous_step":false},"access_token_state":{"use_previous_step":false}}},"position":{"x":225,"y":-1861},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"f9aa21ad-d0ee-44e3-b11a-f1b64e4092f4","code":3,"params":{"version":"8.2.7","variable_name":"http_date_response","variable_value":{"use_previous_step":true},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":197,"y":-1422},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"a2896e2e-55bc-4243-bf04-7e7efe0037cd","code":3,"params":{"version":"4.35.0","variable_name":"date_today","variable_value":{"use_previous_step":false,"statement":"new Date(http_date_response.datetime)"},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":"","command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":199,"y":-1338},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"a2f9d3ec-8602-4b67-a072-92a747e6ba2e","code":3,"params":{"version":"4.35.0","variable_name":"date_to_server","variable_value":{"use_previous_step":false,"statement":"new Date(http_date_response.datetime).toLocaleString()"},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":"","command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":201,"y":-1247},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"b0ea0ff6-3e60-4c05-bf51-11894c859d12","code":11,"params":{"version":"4.35.0","variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"value":"@echo %USERPROFILE%","use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":201,"y":-1148},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"54af40ad-f51f-46f5-99a2-9d4ae0ac1d6b","code":3,"params":{"version":"4.35.0","variable_name":"cmd_result","variable_value":{"use_previous_step":true},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":200,"y":-1076},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"aeafb5fd-766f-4991-98f7-ec00b1b488cf","code":3,"params":{"version":"4.35.0","variable_name":"path_user","variable_value":{"use_previous_step":false,"statement":"cmd_result.replace('\\r\\n','').split(' ').join('')"},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":203,"y":-988},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"2ed0384f-615f-4425-8390-971de23c7d58","code":3,"params":{"version":"4.35.0","variable_name":"path_directory","variable_value":{"use_previous_step":false,"statement":"path_user+'\\\\Documents\\\\Electroneek'"},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":204,"y":-908},"next":{"exit":{"activity_category":2,"activity":{"cell_id":"9407f1f6-8e06-4fe7-b19c-8dc1424fd53b","code":11,"params":{"version":"4.35.0","path":{"use_previous_step":false,"statement":"path_directory"},"content":{"use_previous_step":false},"copy_from":{"use_previous_step":false},"move_to":{"use_previous_step":false,"statement":"robot_name"},"comment":"Создать директорию","breakpoint":false,"source_type":"folder","text_file_type":"plainText","is_replace_existing":true}},"position":{"x":245,"y":-820},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"43af82c6-8b63-4f15-81e0-65bc6a744105","code":3,"params":{"version":"4.35.0","variable_name":"path_directory","variable_value":{"use_previous_step":false,"statement":"path_directory + '\\\\' + robot_name"},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":205,"y":-735},"next":{"exit":{"activity_category":2,"activity":{"cell_id":"9f8163f5-605f-4622-ab92-3d9cc861b1de","code":11,"params":{"version":"4.35.0","path":{"use_previous_step":false,"statement":"path_directory"},"content":{"use_previous_step":false},"copy_from":{"use_previous_step":false},"move_to":{"value":"Logs","use_previous_step":false},"comment":"Создать папку для логов","breakpoint":false,"source_type":"folder","text_file_type":"plainText","is_replace_existing":true}},"position":{"x":222,"y":-639},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"1e7e2541-87aa-4d60-877f-a89c47f26fb0","code":3,"params":{"version":"4.35.0","variable_name":"path_logs","variable_value":{"use_previous_step":false,"statement":"path_directory + '\\\\Logs'"},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":207,"y":-547},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"794b0278-94aa-48dc-b5d7-446589aebf7a","code":3,"params":{"version":"4.35.0","variable_name":"path_database","variable_value":{"use_previous_step":false,"statement":"path_directory + '\\\\Database.xlsx'"},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":208,"y":-462},"next":{"exit":{"activity_category":6,"activity":{"cell_id":"b56373af-6753-4c07-93d9-320d83fc0462","code":1,"params":{"version":"4.35.0","path":{"use_previous_step":false,"statement":"path_database"},"json_value":{"use_previous_step":false},"sheet_name":{"value":"","use_previous_step":false},"row":{"use_previous_step":false},"column_map":{"use_previous_step":false},"dest_path":{"use_previous_step":false},"dest_sheet_name":{"use_previous_step":false},"headers_format":1,"comment":"Прочесть database","breakpoint":false,"from_row":{"use_previous_step":false},"to_row":{"use_previous_step":false},"from_column":{"use_previous_step":false},"to_column":{"use_previous_step":false},"range":{"use_previous_step":false},"cell_value":{"use_previous_step":false},"macros_path":{"use_previous_step":false},"macros_function_name":{"use_previous_step":false},"macros_param":{"use_previous_step":false},"insert_or_delete":"insert","column_count":{"use_previous_step":false},"sort_range":{"use_previous_step":false},"sort_columns":{"use_previous_step":false},"sort_direction":0}},"position":{"x":253,"y":-372},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"188e5ef6-5762-4fc1-a7f4-d7eedbb066c2","code":3,"params":{"version":"4.35.0","variable_name":"all_data","variable_value":{"use_previous_step":true},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":210,"y":-286},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"35dbd245-3866-402f-ab89-8edf89996100","code":1,"params":{"version":"4.35.0","variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"condition":"all_data == null","basicCondition":null,"conditionType":"advanced","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":219,"y":-198},"next":{"yes":{"activity_category":1,"activity":{"cell_id":"8336a597-4e38-4e50-b42e-d51f2a7fcecb","code":3,"params":{"version":"4.35.0","variable_name":"work_deadline","variable_value":{"use_previous_step":false,"statement":"new Date(date_today.toISOString()).setDate(date_today.getDate() + 7)"},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":"Вычитать время запуска + 7 дней","command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":800,"y":-1446},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"0dc1580d-9795-49c8-8808-b0c0c3fd0abf","code":3,"params":{"version":"4.35.0","variable_name":"work_deadline_to_server","variable_value":{"use_previous_step":false,"statement":"new Date(work_deadline).toLocaleString(\"ru\")"},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":799,"y":-1319},"next":{"exit":{"activity_category":12,"activity":{"cell_id":"4d323362-4f39-4bdb-9fc7-20f4681f9e95","code":1,"params":{"version":"4.35.0","description":{"use_previous_step":false,"statement":"'Введите пожалуйста электронный адрес для активации лицензии.'"},"display_window_delay_ms":null,"comment":null,"breakpoint":false,"input_type":"text","radio_buttons":[{"value":"Radio button 1"},{"value":"Radio button 2"}],"title":"Регистрация на портале","select_file_or_folder":"file","number_of_selected_files":"single","number_of_selectd_folders":"single"}},"position":{"x":868,"y":-1197},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"b39e7a2b-6b71-4624-8f5e-6d5c7821d63b","code":3,"params":{"version":"8.2.7","variable_name":"user_input","variable_value":{"use_previous_step":true},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":800,"y":-1120},"next":{"exit":{"activity_category":10,"activity":{"cell_id":"d3a21e36-1758-4f10-a84a-e3b29422e4d5","code":1,"params":{"version":"4.35.0","url":{"value":"https://businessautomation.bitrix24.kz/rest/846/9vzv6ky7d7rar0u8/lists.element.get.json","use_previous_step":false},"request_method":{"value":"post","use_previous_step":false},"query_params":{"use_previous_step":true},"body_params":{"use_previous_step":false,"statement":"{\r\n\t\tIBLOCK_TYPE_ID: \"lists\",\r\n\t\tIBLOCK_ID: 118\r\n\t}"},"basic_auth_username":"","basic_auth_password":"","token":{"value":null,"use_previous_step":false},"file":{"value":"","use_previous_step":false},"file_key":{"value":"","use_previous_step":false},"custom_header":{"use_previous_step":false,"statement":""},"comment":"Запрос","breakpoint":false,"deactivated":false,"login":null,"add_certificate":false,"certificate":null,"authorization_url":{"use_previous_step":false},"access_token_url":{"use_previous_step":false},"client_id":{"use_previous_step":false},"client_secret":{"use_previous_step":false},"access_token_scope":{"use_previous_step":false},"access_token_state":{"use_previous_step":false}}},"position":{"x":868,"y":-1023},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"33716398-490f-4a7d-942a-3ef48255d4c9","code":3,"params":{"version":"4.35.0","variable_name":"response","variable_value":{"use_previous_step":true},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":801,"y":-928},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"5f634495-8264-474a-a5a5-4510e472f2f4","code":3,"params":{"version":"4.35.0","variable_name":"result","variable_value":{"value":"","use_previous_step":false},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":880,"y":-829},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"281ad8f5-8bee-4cf6-b3aa-92c4a19d8693","code":12,"params":{"version":"4.35.0","variable_name":"$previous_result$","variable_value":{"use_previous_step":false,"statement":"let array = []\r\nresponse.result.map((x) => {\r\n\tif (x.PROPERTY_800 && x.PROPERTY_800[Object.keys(x.PROPERTY_800)[0]]) {\r\n\t\tarray.push({\r\n            login: x.PROPERTY_800[Object.keys(x.PROPERTY_800)[0]], \r\n            name: x.PROPERTY_806[Object.keys(x.PROPERTY_806)[0]],\r\n        })\r\n\t}\r\n})\r\n\r\nresult = array"},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":"main_templete_1.js","username":null,"timeout":0}},"position":{"x":802,"y":-757},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"14de5994-10d6-4537-b0af-b0aaf1546fb8","code":1,"params":{"version":"4.35.0","variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"condition":"result.find(x=> x.login === user_input) !== undefined && result.find(x=> x.name === robot_name) !== undefined","basicCondition":null,"conditionType":"advanced","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":801,"y":-607},"next":{"yes":{"activity_category":12,"activity":{"cell_id":"1de624e6-7c76-4fdb-aebd-2817322bfdf1","code":2,"params":{"version":"4.35.0","description":{"use_previous_step":false,"statement":"'Ваш аккаунт уже зарегистрирован в базе данных.'"},"display_window_delay_ms":null,"comment":null,"breakpoint":false,"input_type":"text","radio_buttons":[{"value":"Radio button 1"},{"value":"Radio button 2"}],"select_file_or_folder":"file","number_of_selected_files":"single","number_of_selectd_folders":"single"}},"position":{"x":655,"y":-475},"next":{"exit":{"activity_category":2,"activity":{"cell_id":"100ddecf-7c7c-4674-9cd1-2ff4700b4828","code":3,"params":{"version":"4.35.0","path":{"use_previous_step":false,"statement":"path_logs + `\\\\${date_to_server.replace(/, |:/gi, \"-\")}.txt`"},"content":{"use_previous_step":false,"statement":"new Date().toLocaleString()+\"\\n\"+ \"Работ запущен.\""},"copy_from":{"use_previous_step":false},"move_to":{"use_previous_step":false},"comment":null,"breakpoint":false,"deactivated":false,"source_type":"folder","text_file_type":"plainText","is_subfolders":false,"is_full_path":false,"is_replace_existing":false}},"position":{"x":1921,"y":-336},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"d3bab455-a6ed-41c8-906d-1b551b56a8b9","code":3,"params":{"version":"4.35.0","variable_name":"all_data","variable_value":{"value":"","use_previous_step":false},"is_variable_global":true,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":1917,"y":-264},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"6a1ab4b9-406e-4c71-a60e-c3d24580d4df","code":12,"params":{"version":"4.35.0","variable_name":"$previous_result$","variable_value":{"use_previous_step":false,"statement":"let obj = \r\n    {\r\n        \"Path\": [ \r\n        {\r\n            \"Name\": \"User_path\",\r\n            \"Variable\": path_user\r\n        },\r\n\r\n        {\r\n            \"Name\": \"Directory_path\",\r\n            \"Variable\": path_directory\r\n        },\r\n\r\n        {\r\n            \"Name\": \"Database\",\r\n            \"Variable\": path_database\r\n        },\r\n\r\n        {\r\n            \"Name\": \"Logs\",\r\n            \"Variable\": path_logs\r\n        }\r\n    ],\r\n  \"Time\": [\r\n      {\r\n          \"Name\": \"Date today\",\r\n          \"Variable\": date_today\r\n      }\r\n  ],\r\n  \"Data\": [\r\n      {\r\n          \"Name\": \"Login\",\r\n          \"Variable\": user_input\r\n      },\r\n\r\n      {\r\n          \"Name\": \"Robot name\",\r\n          \"Variable\": robot_name\r\n      }\r\n    ]  \r\n}\r\n\r\nall_data = obj"},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":"main_templete_6.js","username":null,"timeout":0}},"position":{"x":1847,"y":-188},"next":{"exit":{"activity_category":6,"activity":{"cell_id":"a1bdffd9-e2d5-4eb1-bf52-c6393750b52e","code":2,"params":{"version":"4.35.0","path":{"use_previous_step":false,"statement":"path_database"},"json_value":{"use_previous_step":false,"statement":"all_data"},"sheet_name":{"use_previous_step":false},"row":{"use_previous_step":false},"column_map":{"use_previous_step":false},"dest_path":{"use_previous_step":false},"dest_sheet_name":{"use_previous_step":false},"headers_format":0,"comment":"","breakpoint":false,"from_row":{"use_previous_step":false},"to_row":{"use_previous_step":false},"from_column":{"use_previous_step":false},"to_column":{"use_previous_step":false},"range":{"use_previous_step":false},"cell_value":{"use_previous_step":false},"macros_path":{"use_previous_step":false},"macros_function_name":{"use_previous_step":false},"macros_param":{"use_previous_step":false},"insert_or_delete":"insert","column_count":{"use_previous_step":false},"sort_range":{"use_previous_step":false},"sort_columns":{"use_previous_step":false},"sort_direction":0}},"position":{"x":1895,"y":-57},"next":{"exit":{"activity_category":12,"activity":{"cell_id":"f3204512-2927-4450-86e0-307bf4e6d60a","code":2,"params":{"version":"4.35.0","description":{"value":"Регистрация прошла успешно!","use_previous_step":false},"display_window_delay_ms":1000,"comment":null,"breakpoint":false,"input_type":"text","radio_buttons":[{"value":"Radio button 1"},{"value":"Radio button 2"}],"select_file_or_folder":"file","number_of_selected_files":"single","number_of_selectd_folders":"single"}},"position":{"x":1887,"y":25},"next":{"exit":{"activity_category":10,"activity":{"cell_id":"05b7450f-23b6-40c5-815b-113b9089fcce","code":1,"params":{"version":"4.35.0","url":{"value":"https://businessautomation.bitrix24.kz/rest/846/9vzv6ky7d7rar0u8/lists.element.get.json","use_previous_step":false},"request_method":{"value":"post","use_previous_step":false},"query_params":{"use_previous_step":true},"body_params":{"use_previous_step":false,"statement":"{\r\n\t\tIBLOCK_TYPE_ID: \"lists\",\r\n\t\tIBLOCK_ID: 118\r\n\t}"},"basic_auth_username":"","basic_auth_password":"","token":{"value":null,"use_previous_step":false},"file":{"value":"","use_previous_step":false},"file_key":{"value":"","use_previous_step":false},"custom_header":{"use_previous_step":false,"statement":""},"comment":null,"breakpoint":false,"deactivated":false,"login":null,"add_certificate":false,"certificate":null,"authorization_url":{"use_previous_step":false},"access_token_url":{"use_previous_step":false},"client_id":{"use_previous_step":false},"client_secret":{"use_previous_step":false},"access_token_scope":{"use_previous_step":false},"access_token_state":{"use_previous_step":false}}},"position":{"x":1909,"y":93},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"2d2bf399-1e15-4aab-8c95-8897907e8a82","code":3,"params":{"version":"9.1.3","variable_name":"response","variable_value":{"use_previous_step":true},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":1839,"y":168},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"e831153a-3ca4-4976-a958-98f9105298b6","code":1,"params":{"version":"4.35.0","variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"condition":"new Date(date_today).getTime() >= work_deadline","basicCondition":null,"conditionType":"advanced","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":"","command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":351,"y":287},"next":{"yes":{"activity_category":12,"activity":{"cell_id":"df014c3b-14d3-4c8c-b7aa-0eff68c4eafd","code":2,"params":{"version":"4.35.0","description":{"value":"Лицензия продукта окончена. Обратитесь в компанию А-Бизнес для обновления продукта. ","use_previous_step":false},"display_window_delay_ms":9999000,"button_name":"Ок","comment":null,"breakpoint":false,"input_type":"text","radio_buttons":[{"value":"Radio button 1"},{"value":"Radio button 2"}],"select_file_or_folder":"file","number_of_selected_files":"single","number_of_selectd_folders":"single"}},"position":{"x":78,"y":397},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"2b4487a0-00d9-4834-a074-8c62f0a023e4","code":3,"params":{"version":"4.35.0","variable_name":"exit","variable_value":{"use_previous_step":false,"statement":"true"},"is_variable_global":true,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":112,"y":487},"next":{}}}},"no":{"activity_category":1,"activity":{"cell_id":"eeb8b996-e40e-4932-acdf-a74893d82323","code":3,"params":{"version":"4.35.0","variable_name":"time_left","variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":435,"y":454},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"7c15bb04-83ce-4a0f-b88b-fcef094869b7","code":1,"params":{"version":"4.35.0","variable_name":null,"variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"condition":"(new Date(date_today).getTime() + 432000000) >= work_deadline","basicCondition":null,"conditionType":"advanced","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":368,"y":528},"next":{"yes":{"activity_category":1,"activity":{"cell_id":"f1e49fd6-2d06-499e-adc2-ff1d8e97c87c","code":3,"params":{"version":"4.35.0","variable_name":"time_left","variable_value":{"use_previous_step":false,"statement":"Math.round((work_deadline - new Date(date_today).getTime()) / (1000 * 60 * 60 * 24))"},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":70,"y":650},"next":{"exit":{"activity_category":12,"activity":{"cell_id":"65a006b3-b933-4836-b8ed-bd1bc2ca244a","code":2,"params":{"version":"4.35.0","description":{"use_previous_step":false,"statement":"`Дорогой клиент, до истечения срока лицензии осталось всего ${time_left} дней.`"},"display_window_delay_ms":10000,"button_name":"Ok","comment":null,"breakpoint":false,"deactivated":false,"input_type":"text","radio_buttons":[{"value":"Radio button 1"},{"value":"Radio button 2"}],"title":null,"select_file_or_folder":"file","number_of_selected_files":"single","filter_files_by_extension":false,"files_filter_extension":null,"number_of_selectd_folders":"single"}},"position":{"x":111,"y":765},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"5ba03e86-0249-4a0a-abb6-36d3bdfdab45","code":3,"params":{"version":"4.35.0","variable_name":"logs_post","variable_value":{"value":"","use_previous_step":false},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":594,"y":714},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"6cec1cab-ca83-45fd-ba73-41adf907ee44","code":3,"params":{"version":"4.35.0","variable_name":"update_post_db","variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":569,"y":787},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"7b704860-6713-4189-9db9-5cb7d2408659","code":12,"params":{"version":"4.35.0","variable_name":"$previous_result$","variable_value":{"use_previous_step":false,"statement":"let find = response.result.find(x => x.PROPERTY_800[Object.keys(x.PROPERTY_800)[0]] === all_data.Data[0].Variable)\r\n\r\nlet update_db = {\r\n    IBLOCK_TYPE_ID: \"lists\",\r\n\tIBLOCK_ID: 118,\r\n    ELEMENT_CODE: find.CODE,\r\n    FIELDS: {\r\n        NAME: find.NAME,\r\n        PROPERTY_818: time_left == \"\" ? null : time_left,\r\n        PROPERTY_800: find.PROPERTY_800,\r\n        PROPERTY_802: find.PROPERTY_802,\r\n        PROPERTY_804: find.PROPERTY_804,\r\n        PROPERTY_806: find.PROPERTY_806\r\n    }\r\n}\r\n\r\nlet result = {\r\n\tIBLOCK_TYPE_ID: \"lists\",\r\n\tIBLOCK_ID: 114,\r\n    ELEMENT_CODE: genElement(),\r\n    FIELDS: {\r\n        NAME: \"Robot\",\r\n        PROPERTY_808: robot_name,\r\n        PROPERTY_810: all_data.Data[0].Variable,\r\n        PROPERTY_812: date_to_server,\r\n        PROPERTY_814: http_date_response.client_ip,\r\n        PROPERTY_820: time_left == \"\" ? null : time_left\r\n    }\r\n}\r\n\r\nfunction genElement() {\r\n    let charSet = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!#$%^&()\"\r\n    let randomString = \"\"\r\n    for (var i = 0; i < 15; i++) {\r\n        randomPoz = Math.floor(Math.random() * charSet.length)\r\n        randomString += charSet.substring(randomPoz, randomPoz + 1)\r\n    }\r\n    return randomString\r\n}\r\n\r\nlogs_post = result\r\nupdate_post_db = update_db\r\n"},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":"main_templete_3.js","username":null,"timeout":0}},"position":{"x":520,"y":865},"next":{"exit":{"activity_category":10,"activity":{"cell_id":"1576d848-522c-4229-98f4-21bed791d8ea","code":1,"params":{"version":"4.35.0","url":{"value":"https://businessautomation.bitrix24.kz/rest/846/9vzv6ky7d7rar0u8/lists.element.update.json","use_previous_step":false},"request_method":{"value":"post","use_previous_step":false},"query_params":{"use_previous_step":true},"body_params":{"use_previous_step":false,"statement":"update_post_db"},"basic_auth_username":"","basic_auth_password":"","token":{"value":null,"use_previous_step":false},"file":{"value":"","use_previous_step":false},"file_key":{"value":"","use_previous_step":false},"custom_header":{"use_previous_step":false,"statement":""},"comment":"Обновить инфо в БД","breakpoint":false,"deactivated":true,"login":null,"add_certificate":false,"certificate":null,"authorization_url":{"use_previous_step":false},"access_token_url":{"use_previous_step":false},"client_id":{"use_previous_step":false},"client_secret":{"use_previous_step":false},"access_token_scope":{"use_previous_step":false},"access_token_state":{"use_previous_step":false}}},"position":{"x":569,"y":1008},"next":{"exit":{"activity_category":10,"activity":{"cell_id":"6f04b9cb-6e80-42d6-9494-9e873ecff0c7","code":1,"params":{"version":"4.35.0","url":{"value":"https://businessautomation.bitrix24.kz/rest/846/9vzv6ky7d7rar0u8/lists.element.add.json","use_previous_step":false},"request_method":{"value":"post","use_previous_step":false},"query_params":{"use_previous_step":true},"body_params":{"use_previous_step":false,"statement":"logs_post"},"basic_auth_username":"","basic_auth_password":"","token":{"value":null,"use_previous_step":false},"file":{"value":"","use_previous_step":false},"file_key":{"value":"","use_previous_step":false},"custom_header":{"use_previous_step":false,"statement":""},"comment":"Отправить лог о запуске","breakpoint":false,"deactivated":true,"login":null,"add_certificate":false,"certificate":null,"authorization_url":{"use_previous_step":false},"access_token_url":{"use_previous_step":false},"client_id":{"use_previous_step":false},"client_secret":{"use_previous_step":false},"access_token_scope":{"use_previous_step":false},"access_token_state":{"use_previous_step":false}}},"position":{"x":544,"y":1101},"next":{"exit":{"activity_category":12,"activity":{"cell_id":"3f3e109c-38f8-4ea1-88c6-fe7c1a396023","code":2,"params":{"version":"4.35.0","description":{"value":"Робот запущен!","use_previous_step":false},"display_window_delay_ms":1000,"button_name":"Ок","comment":null,"breakpoint":false,"input_type":"text","radio_buttons":[{"value":"Radio button 1"},{"value":"Radio button 2"}],"select_file_or_folder":"file","number_of_selected_files":"single","number_of_selectd_folders":"single"}},"position":{"x":572,"y":1191},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"697dbb22-2d68-42b7-a4f3-5d21f3798b6e","code":3,"params":{"version":"4.35.0","variable_name":"exit","variable_value":{"use_previous_step":false,"statement":"false"},"is_variable_global":true,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":605,"y":1283},"next":{}}}}}}}}}}}}}}}}}},"no":{"$type":"ref","value":["start-0","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","yes","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","yes","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","no","next","exit","next","yes","next","exit","next","exit"]}}}}}}}}}}}}}}}}}}}}}}},"no":{"activity_category":12,"activity":{"cell_id":"90ba4ef0-29b1-4156-8d86-a3244140644a","code":2,"params":{"version":"4.35.0","description":{"use_previous_step":false,"statement":"'Робот отправит письмо с кодом на адрес ' + user_input"},"display_window_delay_ms":1000,"button_name":"Ok","comment":null,"breakpoint":false,"input_type":"text","radio_buttons":[{"value":"Radio button 1"},{"value":"Radio button 2"}],"select_file_or_folder":"file","number_of_selected_files":"single","number_of_selectd_folders":"single"}},"position":{"x":984,"y":-474},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"a44adb6e-c818-455f-b4a3-e60bbe5ade85","code":3,"params":{"version":"4.35.0","variable_name":"chek_password","variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":1723,"y":-1466},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"4e8fee0c-ccb9-449b-8715-6e29ba8a3bd1","code":12,"params":{"version":"4.35.0","variable_name":"$previous_result$","variable_value":{"use_previous_step":false,"statement":"function genElement() {\r\n    let charSet = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!#$%^&()\"\r\n    let randomString = \"\"\r\n    for (var i = 0; i < 15; i++) {\r\n        randomPoz = Math.floor(Math.random() * charSet.length)\r\n        randomString += charSet.substring(randomPoz, randomPoz + 1)\r\n    }\r\n    return randomString\r\n}\r\nchek_password = genElement()"},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":"Генерация кода для проверки","command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":"main_templete_5.js","username":null,"timeout":0}},"position":{"x":1675,"y":-1394},"next":{"exit":{"activity_category":7,"activity":{"cell_id":"749b2722-5fc8-4272-a2e8-9d9a2a3ce9d7","code":1,"params":{"version":"4.35.0","to":{"use_previous_step":false,"statement":"user_input"},"cc":{"value":"","use_previous_step":false},"bcc":{"value":"","use_previous_step":false},"subject":{"use_previous_step":false,"statement":"'Регистрация робота'"},"body":{"use_previous_step":false,"statement":"'Регистрация робота ' + robot_name + ' на ваш электронный адрес.\\n Для подтверждения введите данный код в окне ввода робота: ' + chek_password"},"date_from":{"use_previous_step":false},"attachment_path":{"value":"","use_previous_step":false},"attachment_save_template":{"use_previous_step":false},"attachment_save":false,"attachment_save_duplicate":true,"server_host":{"use_previous_step":false},"server_secure":true,"server_type":"yandex","bcc_to_sender":false,"comment":"Отправляем email пользователю","breakpoint":false,"deactivated":true,"box_name":{"use_previous_step":false},"login":null,"subject_contains":{"use_previous_step":false},"body_contains":{"use_previous_step":false},"sender":{"use_previous_step":false},"attachment_filter":"all","mark_as_read":true,"emails_limit":{"value":"","use_previous_step":false},"move_to_folder":false,"move_folder":{"use_previous_step":false},"load_one_by_one":false}},"position":{"x":1673,"y":-1256},"next":{"exit":{"activity_category":12,"activity":{"cell_id":"b40b18df-514c-43aa-86c7-f36a9d301567","code":1,"params":{"version":"4.35.0","description":{"use_previous_step":false,"statement":"'Робот выслал вам на почту код, для завершения регистрации введите его в этом окне.'"},"display_window_delay_ms":null,"comment":"Ввод кода для проверки ","breakpoint":false,"input_type":"text","radio_buttons":[{"value":"Radio button 1"},{"value":"Radio button 2"}],"title":"Ввод кода проверки","select_file_or_folder":"file","number_of_selected_files":"single","number_of_selectd_folders":"single"}},"position":{"x":1695,"y":-1167},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"3f8f52cf-92ae-4449-a435-a21e82e756eb","code":3,"params":{"version":"8.2.7","variable_name":"user_input_password","variable_value":{"use_previous_step":true},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":1675,"y":-1081},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"0469e308-0227-4edc-a6d8-1e1ebd4c2741","code":1,"params":{"version":"4.35.0","variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"condition":"user_input_password != chek_password","basicCondition":null,"conditionType":"advanced","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":1673,"y":-992},"next":{"yes":{"activity_category":12,"activity":{"cell_id":"f1ec2c6d-9468-47e9-8034-bb8870b2349a","code":1,"params":{"version":"4.35.0","description":{"value":"Не верный код!","use_previous_step":false},"display_window_delay_ms":null,"button_name":null,"comment":null,"breakpoint":false,"deactivated":false,"input_type":"radio_button","radio_buttons":[{"value":"Ввести код снова"},{"value":"Изменить электронный адрес"}],"title":"","select_file_or_folder":"file","number_of_selected_files":"single","filter_files_by_extension":false,"files_filter_extension":null,"number_of_selectd_folders":"single"}},"position":{"x":1403,"y":-870},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"79f254e5-f74b-4cb4-8035-2714000a3351","code":3,"params":{"version":"9.0.4","variable_name":"error_input","variable_value":{"use_previous_step":true},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":1398,"y":-797},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"d5af35e7-8845-42fc-b8e6-94c9a374647d","code":1,"params":{"version":"4.35.0","variable_name":null,"variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"condition":"error_input == 'Изменить электронный адрес'","basicCondition":null,"conditionType":"advanced","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":1396,"y":-711},"next":{"yes":{"$type":"ref","value":["start-0","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","yes","next","exit","next","exit"]},"no":{"$type":"ref","value":["start-0","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","yes","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","no","next","exit","next","exit","next","exit","next","exit"]}}}}}}},"no":{"activity_category":12,"activity":{"cell_id":"5b54cb0a-f37e-4aed-b81a-420f6a4d2812","code":2,"params":{"version":"4.35.0","description":{"use_previous_step":false,"statement":"'Робот создаёт пользователя в базе данных...'"},"display_window_delay_ms":1000,"comment":null,"breakpoint":false,"input_type":"text","radio_buttons":[{"value":"Radio button 1"},{"value":"Radio button 2"}],"select_file_or_folder":"file","number_of_selected_files":"single","number_of_selectd_folders":"single"}},"position":{"x":1884,"y":-869},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"741d8012-6aec-403f-b7b4-809045be705d","code":3,"params":{"version":"4.35.0","variable_name":"post","variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":1919,"y":-794},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"5679298a-f33c-4ec6-a1a3-eb5523c24211","code":12,"params":{"version":"4.35.0","variable_name":"$previous_result$","variable_value":{"use_previous_step":false,"statement":"\r\n\r\nlet result = {\r\n\tIBLOCK_TYPE_ID: \"lists\",\r\n\tIBLOCK_ID: 118,\r\n    ELEMENT_CODE: genElement(),\r\n    FIELDS: {\r\n        NAME: genElement(),\r\n        PROPERTY_800: user_input,\r\n        PROPERTY_802: date_to_server,\r\n        PROPERTY_804: work_deadline_to_server,\r\n        PROPERTY_806: robot_name\r\n    }\r\n}\r\n\r\nfunction genElement() {\r\n    let charSet = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!#$%^&()\"\r\n    let randomString = \"\"\r\n    for (var i = 0; i < 15; i++) {\r\n        randomPoz = Math.floor(Math.random() * charSet.length)\r\n        randomString += charSet.substring(randomPoz, randomPoz + 1)\r\n    }\r\n    return randomString\r\n}\r\n\r\npost = result"},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":"main_templete_2.js","username":null,"timeout":0}},"position":{"x":1842,"y":-719},"next":{"exit":{"activity_category":10,"activity":{"cell_id":"9b7e3c47-35d3-4ba8-a829-54ff41a2f5e1","code":1,"params":{"version":"4.35.0","url":{"value":"https://businessautomation.bitrix24.kz/rest/846/9vzv6ky7d7rar0u8/lists.element.add.json","use_previous_step":false},"request_method":{"value":"post","use_previous_step":false},"query_params":{"use_previous_step":true},"body_params":{"use_previous_step":false,"statement":"post"},"basic_auth_username":"","basic_auth_password":"","token":{"value":null,"use_previous_step":false},"file":{"value":"","use_previous_step":false},"file_key":{"value":"","use_previous_step":false},"custom_header":{"use_previous_step":false,"statement":""},"comment":"Создание пользователя","breakpoint":false,"login":null,"add_certificate":false,"certificate":null,"authorization_url":{"use_previous_step":false},"access_token_url":{"use_previous_step":false},"client_id":{"use_previous_step":false},"client_secret":{"use_previous_step":false},"access_token_scope":{"use_previous_step":false},"access_token_state":{"use_previous_step":false}}},"position":{"x":1866,"y":-579},"next":{"exit":{"$type":"ref","value":["start-0","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","yes","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","yes","next","exit"]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"no":{"activity_category":10,"activity":{"cell_id":"c5babc9b-7406-48e0-9f5c-fa1a7a1b8216","code":1,"params":{"version":"4.35.0","url":{"value":"https://businessautomation.bitrix24.kz/rest/1674/sof10cakbp4r33yk/lists.element.get.json","use_previous_step":false},"request_method":{"value":"post","use_previous_step":false},"query_params":{"use_previous_step":true},"body_params":{"use_previous_step":false,"statement":"{\r\n\t\tIBLOCK_TYPE_ID: \"lists\",\r\n\t\tIBLOCK_ID: 118\r\n\t}"},"basic_auth_username":"","basic_auth_password":"","token":{"value":null,"use_previous_step":false},"file":{"value":"","use_previous_step":false},"file_key":{"value":"","use_previous_step":false},"custom_header":{"use_previous_step":false,"statement":""},"comment":"Запрос в Битрикс 24","breakpoint":false,"login":null,"add_certificate":false,"certificate":null,"authorization_url":{"use_previous_step":false},"access_token_url":{"use_previous_step":false},"client_id":{"use_previous_step":false},"client_secret":{"use_previous_step":false},"access_token_scope":{"use_previous_step":false},"access_token_state":{"use_previous_step":false}}},"position":{"x":392,"y":-111},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"74a061f2-9400-426d-ada9-b46c4bd44c92","code":3,"params":{"version":"4.35.0","variable_name":"response","variable_value":{"use_previous_step":true},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":352,"y":-30},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"e4f089cd-df7a-4551-ba8d-59c1ff9b406c","code":3,"params":{"version":"4.35.0","variable_name":"work_deadline","variable_value":{"use_previous_step":false,"statement":""},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":412,"y":58},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"3c4c1386-bfd7-4e03-8b63-f093bb311858","code":12,"params":{"version":"4.35.0","variable_name":"$previous_result$","variable_value":{"use_previous_step":false,"statement":"let find = response.result.find(x => x.PROPERTY_800[Object.keys(x.PROPERTY_800)[0]] === all_data.Data[0].Variable)\r\n\r\nif (find == undefined) return work_deadline = 0\r\nlet time = find.PROPERTY_804[Object.keys(find.PROPERTY_804)[0]]\r\nlet arr = time.split(\".\").toString().replace(/,/gi, \"/\").replace(/ /gi, \"/\").replace(/:/gi, \"/\").split(\"/\")\r\nlet date = new Date(arr[2], arr[1], arr[0], arr[3], arr[4], arr[5])\r\n\r\nlet hours = new Date(date.setHours(date.getHours() + 3))\r\nwork_deadline = new Date(hours.setMonth(hours.getMonth() - 1))\r\narray = arr"},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":"main_templete_4.js","username":null,"timeout":0}},"position":{"x":351,"y":139},"next":{"exit":{"$type":"ref","value":["start-0","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","yes","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","yes","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit"]}}}}}}}}}}}}},"error":{"$type":"ref","value":["start-0","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","yes"]}}}}}}}}}}}}}}}}}}}}}}}}}}},"error":{"activity_category":10,"activity":{"cell_id":"a3ca6363-e0e0-43f6-a0be-1a44c5b7c9f1","code":1,"params":{"version":"4.35.0","url":{"value":"https://yandex.com/time/sync.json?geo=164","use_previous_step":false},"request_method":{"value":"get","use_previous_step":false},"query_params":{"use_previous_step":true},"body_params":{"use_previous_step":true},"basic_auth_username":"","basic_auth_password":"","token":{"value":null,"use_previous_step":false},"file":{"use_previous_step":false},"file_key":{"use_previous_step":false},"custom_header":{"use_previous_step":false,"statement":""},"comment":"Получить точное время","breakpoint":false,"login":null,"add_certificate":false,"certificate":null,"authorization_url":{"use_previous_step":false},"access_token_url":{"use_previous_step":false},"client_id":{"use_previous_step":false},"client_secret":{"use_previous_step":false},"access_token_scope":{"use_previous_step":false},"access_token_state":{"use_previous_step":false}}},"position":{"x":410.5,"y":-1729.5},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"0c2a1bae-b690-4f53-89d4-3c2c5f7a02ba","code":3,"params":{"version":"4.35.0","variable_name":"res_answer","variable_value":{"use_previous_step":true},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":398.5,"y":-1649.5},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"61b997b5-3df6-46e3-95f2-2054f3828ae6","code":3,"params":{"version":"4.35.0","variable_name":"http_date_response","variable_value":{"use_previous_step":false,"statement":"{\r\n    datetime: res_answer.time\r\n}"},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":388,"y":-1572},"next":{"exit":{"$type":"ref","value":["start-0","next","exit","next","exit","next","exit","next","exit"]}}}}},"error":{"$type":"ref","value":["start-0","next","exit","next","exit"]}}}}}}}}}},{"start":{"activity_category":1,"activity":{"cell_id":"afbe9838-5afe-43cb-bc58-3949546e3e4b","code":0,"params":{"version":"4.35.0","variable_name":null,"variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":"- path_user - имя пользователя\n\n- path_directory - папка, в которой хранятся данные робота\n\n- path_database - путь к файлу базы данных\n\n- path_logs - папка, в которой хранятся логи.","command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":-94,"y":-1856},"next":{"exit":{"$type":"ref","value":["start-1"]}}}}]