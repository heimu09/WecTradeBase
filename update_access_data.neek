[{"start":{"activity_category":1,"activity":{"cell_id":"ccd6ee96-571f-4756-a3ee-b6a0d9c3eca2","code":8,"params":{"version":"4.0.0","variable_value":{"use_previous_step":false},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"script_id":"7e035647-70dc-443e-94ab-6900364dfff6","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"studio_version":{"created":"9.1.4","updated":"9.2.12"},"paper_size":{"height":2222.2223052978516,"width":2222.2223052978516,"x":-55.55555725097656,"y":-55.55555725097656},"js_file_path":null,"username":null,"timeout":0,"link_vertices":{},"project":{"name":"WecTradeBase","path":"C:\\Users\\User1\\Documents\\WecTradeBase","main":"main.neek","settings":{"variables":[],"performanceSettings":{"automaticallyCreateLogForEachRun":false,"isStatusWindowEnabled":true},"browserSettings":{"useDefaultProfile":true,"useBrowser":"ie","customArgs":"","keepBrowserOpen":true},"doNotCloseWhileDebug":false,"microsoftExcelActivities":"generic","antiCaptcha":true}}}},"position":{"x":285,"y":0},"next":{"exit":{"activity_category":10,"activity":{"cell_id":"34aa79de-bbf4-41cf-bb26-19159bdfdfdc","code":1,"params":{"version":"4.35.0","url":{"value":"https://wectradekz.amocrm.ru/oauth2/access_token","use_previous_step":false},"request_method":{"value":"post","use_previous_step":false},"query_params":{"use_previous_step":true},"body_params":{"use_previous_step":false,"statement":"{\r\n  \"client_id\": \"0ef8113b-d670-4ef1-8805-2d68884be26a\",\r\n  \"client_secret\": \"IEsS9EtFQh4SQyCV7nH6K2Z5t9R3YuBqqkTZ0gn3tMyJbIu83sn9Emb4r9yw0Tas\",\r\n  \"grant_type\": \"refresh_token\",\r\n  \"refresh_token\": access_data[\"Data\"][0][\"refresh_token\"],\r\n  \"redirect_uri\": \"https://wectradekz.amocrm.ru\"\r\n}"},"basic_auth_username":"","basic_auth_password":"","token":{"value":null,"use_previous_step":false},"file":{"value":"","use_previous_step":false},"file_key":{"value":"","use_previous_step":false},"custom_header":{"use_previous_step":false,"statement":""},"comment":"Запрос на востонавление токенов","breakpoint":false,"deactivated":false,"login":null,"add_certificate":false,"certificate":null,"authorization_url":{"use_previous_step":false},"access_token_url":{"use_previous_step":false},"client_id":{"use_previous_step":false},"client_secret":{"use_previous_step":false},"access_token_scope":{"use_previous_step":false},"access_token_state":{"use_previous_step":false}}},"position":{"x":175,"y":110},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"63121496-9758-4632-8e1c-bac832628b89","code":3,"params":{"version":"9.0.3","variable_name":"access_data","variable_value":{"use_previous_step":true},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":"Запись новой информации аунтитификации в переменную","command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":0,"y":332.4},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"8c26685c-b2c0-48ec-ab57-7529470534da","code":3,"params":{"version":"4.35.0","variable_name":"access_token","variable_value":{"use_previous_step":false,"statement":""},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":"Токен авторизации используется во всех телах запросов, повторно сгенерированная","command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":0,"y":456.4},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"27b15cad-d459-4f0c-aa20-79831a24b28e","code":3,"params":{"version":"4.35.0","variable_name":"refresh_token","variable_value":{"use_previous_step":false,"statement":""},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":"Токен для востановления access токена по истечению срока, повторно сгенерированная","command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":0,"y":580.4},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"0410c93f-7942-4597-9b20-a2a5ddc333d8","code":12,"params":{"version":"4.35.0","variable_name":"$previous_result$","variable_value":{"use_previous_step":false,"statement":"access_token = access_data[\"access_token\"];\r\nrefresh_token = access_data[\"refresh_token\"];"},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":"Перезапись переменных","command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":"update_access_data_1.js","username":null,"timeout":0}},"position":{"x":0,"y":704.4},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"5c9c3f26-342f-4dde-9543-39cd175ef3e1","code":3,"params":{"version":"4.35.0","variable_name":"access_data","variable_value":{"use_previous_step":false,"statement":"{\"Data\":[{\"refresh_token\":access_data['refresh_token'],\"access_token\":access_data['access_token']}]}"},"is_variable_global":true,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":0,"y":841.2},"next":{"exit":{"activity_category":6,"activity":{"cell_id":"8459b8a4-1089-4988-adc8-e5e8d544a2e8","code":2,"params":{"version":"4.35.0","path":{"use_previous_step":false,"statement":"`${path_directory}\\\\access_data.xlsx`"},"json_value":{"use_previous_step":false,"statement":"{\"Data\": [\r\n    {\r\n        \"refresh_token\": refresh_token,\r\n        \"access_token\": access_token\r\n    }\r\n]}"},"sheet_name":{"use_previous_step":false},"row":{"use_previous_step":false},"column_map":{"use_previous_step":false},"dest_path":{"use_previous_step":false},"dest_sheet_name":{"use_previous_step":false},"headers_format":0,"comment":"Запись авторизационных данных","breakpoint":false,"deactivated":false,"from_row":{"use_previous_step":false},"to_row":{"use_previous_step":false},"from_column":{"use_previous_step":false},"to_column":{"use_previous_step":false},"range":{"use_previous_step":false},"cell_value":{"use_previous_step":false},"macros_path":{"use_previous_step":false},"macros_function_name":{"use_previous_step":false},"macros_param":{"use_previous_step":false},"insert_or_delete":"insert","column_count":{"use_previous_step":false},"sort_range":{"use_previous_step":false},"sort_columns":{"use_previous_step":false},"sort_direction":0}},"position":{"x":0,"y":965.2},"next":{}}}}}}}}}}}},"error":{"activity_category":1,"activity":{"cell_id":"1464914d-281a-4fea-8dd5-30df7c1ac528","code":3,"params":{"version":"4.35.0","variable_name":"error","variable_value":{"use_previous_step":true},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":350,"y":351.59999999999997},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"1f94f5cb-7f41-452b-bcec-d186df6f3a2c","code":14,"params":{"version":"4.35.0","variable_name":null,"variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":true},"log_message":{"use_previous_step":true},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":423.2,"y":475.59999999999997},"next":{"exit":{"activity_category":12,"activity":{"cell_id":"aeafbbda-3fc0-4a68-a52f-a3963a92d944","code":2,"params":{"version":"4.35.0","description":{"use_previous_step":false,"statement":"`Не удалось установит соединение с amocrm\r\n${error}`"},"display_window_delay_ms":2000,"button_name":"OK","comment":null,"breakpoint":false,"deactivated":false,"input_type":"text","radio_buttons":[{"value":"Radio button 1"},{"value":"Radio button 2"}],"title":null,"select_file_or_folder":"file","number_of_selected_files":"single","filter_files_by_extension":false,"files_filter_extension":null,"number_of_selectd_folders":"single"}},"position":{"x":394.4,"y":599.6},"next":{}}}}}}}}}}}]